<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>辞書</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <input type="text" id="search-box" placeholder="検索...">
    <div id="dictionary-container"></div>

    <script src="dictionary.js"></script>
    <script>
        const container = document.getElementById('dictionary-container');
        const searchBox = document.getElementById('search-box');

        const bopomofoOrder = "ㄅㄆㄇㄈㄉㄊㄋㄌㄍㄎㄏㄐㄑㄒㄓㄔㄕㄖㄗㄘㄙㄚㄛㄜㄝㄞㄟㄠㄡㄢㄣㄤㄥㄦㄧㄨㄩ";
        const compareBopomofo = (a, b) => {
            const aIndex = bopomofoOrder.indexOf(a.bopomofo[0]);
            const bIndex = bopomofoOrder.indexOf(b.bopomofo[0]);
            return aIndex - bIndex;
        };

        function displayDictionary(entries) {
            container.innerHTML = '';
            entries.forEach(entry => {
                const wordCard = document.createElement('div');
                wordCard.classList.add('word-card');

                const word = document.createElement('h2');
                word.textContent = entry.word;
                word.classList.add('HotalSans'); // フォントを適用
                wordCard.appendChild(word);

                const pronunciation = document.createElement('p');
                pronunciation.textContent = `発音: ${entry.pronunciation} (${entry.bopomofo})`;
                wordCard.appendChild(pronunciation);

                entry.mean.forEach(mean => {
                    const type = document.createElement('p');
                    type.textContent = mean.type;
                    type.classList.add(mean.type);
                    wordCard.appendChild(type);

                    mean.explanation.forEach(exp => {
                        const translate = document.createElement('p');
                        translate.textContent = exp.translate;
                        wordCard.appendChild(translate);

                        exp.example.forEach(ex => {
                            const exampleFrame = document.createElement('div');
                            exampleFrame.classList.add('example-frame');

                            const exampleHT = document.createElement('p');
                            exampleHT.textContent = ex.ht;
                            exampleHT.classList.add('HotalSans'); // フォントを適用
                            exampleFrame.appendChild(exampleHT);

                            const exampleJA = document.createElement('p');
                            exampleJA.textContent = ex.ja;
                            exampleFrame.appendChild(exampleJA);

                            const exampleHTPron = document.createElement('p');
                            exampleHTPron.textContent = ex.htPron;
                            exampleFrame.appendChild(exampleHTPron);

                            wordCard.appendChild(exampleFrame);
                        });
                    });
                });

                container.appendChild(wordCard);
            });
        }

        function searchDictionary(query) {
            const filteredEntries = dictionary.filter(entry => {
                return entry.word.includes(query) || entry.mean.some(mean => {
                    return mean.explanation.some(exp => {
                        return exp.translate.includes(query) || exp.example.some(ex => ex.ht.includes(query));
                    });
                });
            });
            displayDictionary(filteredEntries);
        }

        searchBox.addEventListener('input', () => {
            const query = searchBox.value;
            searchDictionary(query);
        });

        // 初期表示
        dictionary.sort(compareBopomofo);
        displayDictionary(dictionary);
    </script>
</body>
</html>
